# 反思|Android 列表分页组件Paging的设计与实现：系统概述

## 前言

本文将对`Paging`分页组件的设计和实现进行一个系统整体的概述，**强烈建议** 读者将本文作为学习`Paging` **阅读优先级最高的文章**，所有其它的`Paging`中文博客阅读优先级都应该靠后。

本文篇幅 **极长**，整体结构思维导图如下：

![](https://raw.githubusercontent.com/qingmei2/qingmei2-blogs-art/master/android/jetpack/paging/image.y4rdl3xz6rj.png)

## 一、起源

手机应用中，列表是常见的界面构成元素，而对于Android开发者而言，`RecyclerView`是实现列表的不二选择。

在正式讨论`Paging`和列表分页功能之前，我们首先看看对于一个普通的列表，开发者如何通过代码对其进行建模：

![](https://raw.githubusercontent.com/qingmei2/qingmei2-blogs-art/master/android/jetpack/paging/thinking_in_android/image.hrp8e3vf6lk.png)

如图所示，针对这样一个简单 **联系人界面** 的建模，我们引出3个重要的角色：

### 1.1 服务端组件、数据库、内存

为什么说 **服务端组件**、**数据库** 以及 **内存** 是非常重要的三个角色呢？

首先，开发者为当前页面创建了一个`ViewModel`，并通过成员变量在 **内存** 中持有了一组联系人数据，因为`ViewModel`组件的原因，即使页面配置发生了改变（比如屏幕的旋转），数据依然会被保留下来。

而 **数据库** 的作用则保证了`App`即使在离线环境下，用户依然可以看到一定的内容——显然对于上图中的页面（联系人列表）而言，本地缓存是非常有意义的。

对于绝大多数列表而言，**服务端** 往往意味着是数据源，每当用户执行刷新操作，`App`都应当尝试向服务端请求最新的数据，并将最新的数据存入 **数据库**，并随之展示在`UI`上。

通常情况下，这三个角色并非同时都是必要的，读者需正确理解三者各自不同的使用场景。

现在，借助于 **服务端组件**、**数据库** 以及 **内存**，开发者将数据展示在`RecyclerView`上，这似乎已经是正解了。

### 1.2 数据源问题

到目前为止，问题还没有完全暴露出来。

我们忽视了一个非常现实的问题，那就是 **数据是动态的**——这意味着，每当数据发生了变化（比如下拉刷新），开发者都需要将最新的数据响应在`UI`上。
